[target]
name = "git-viz"
path = "/Users/dannyliu/personal_projects/git-viz"
branch = "main"
objective = """
Create a visualization tool to track git commits in a meaningful way for devs to understand the history of a codebase. Each commit should be a node displaying the key changes effectively and the overall structure should be a tree.

EXISTING CODEBASE:
- FastAPI backend already exists with endpoints: /api/repo, /api/commits, /api/tree, /api/activity
- Frontend HTML file exists at src/git_viz/index.html with D3.js force-directed graph
- Tests exist in tests/test_api.py with temp git repo fixtures
- Server runs on port 8766, defaults to visualizing its own repo

WHAT TO BUILD:
1. Refactor the visualization from a force-directed graph to a TREE layout (D3 tree/dendrogram)
   - Each commit is a node in the tree
   - Branch structure determines the tree hierarchy
   - Nodes show: short hash, author, date, and a summary of key changes (files changed, insertions/deletions)
   - Merge commits show as nodes where branches rejoin
   - Color-code nodes by author
   - Node size or visual weight reflects the magnitude of changes

2. Interactive commit detail panel
   - Click a commit node to see full details: message, file list, diff stats
   - Highlight the path from that commit to HEAD
   - Show parent/child relationships clearly

3. Navigation and filtering
   - Zoom and pan the tree
   - Search commits by message or author
   - Filter by date range
   - Collapse/expand subtrees for large histories

4. Keep the existing backend API endpoints working (they provide the data)
   - May need to add a new endpoint or modify /api/commits to include parent hashes for tree construction
   - All endpoints default to this repo when no path parameter is given

5. Dark theme, smooth transitions, responsive layout
   - Must handle repos with 500+ commits without freezing

TESTING:
- Keep existing backend tests passing
- Test any new/modified endpoints
- Verify tree renders correctly with the temp git repo fixtures

ARCHITECTURE:
- Frontend remains a single self-contained HTML file (inline CSS/JS, D3 via CDN)
- Backend continues serving JSON, frontend fetches on load
- No WebSocket -- load all data upfront, render client-side
"""

[target.verification]
command = ".venv/bin/python -m pytest -q && .venv/bin/ruff check src/"
timeout = 300
setup_command = "uv sync"
setup_timeout = 120

[scheduler]
session_timeout = 2700
model = "opus"

[scheduler.parallel]
num_workers = 2

[scheduler.budget]
max_per_session_usd = 10.0
max_per_run_usd = 50.0

[continuous]
max_wall_time_seconds = 7200
